--- 
title: "A Guide to Collection & Calculation of Cadre Harmonise Food Security Indicators - beta version"
author: "Research, Assesment and Monitoring (RAM) Team
         Regional Bureau Dakar
         World Food Programme
         rbd.vam@wfp.org"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
---

# Purpose & How to use this Guide

This guide proposes a uniform way of collecting and analyzing key food security indicators for the Cadre Harmonise process.

Chapters are listed by indicator and include:

1. standardized data collection modules and ODK compliant xlsforms
2. sample data set 
3. standardized syntax in SPSS and R
4. references / official guidelines / source materials for the indicators



<!--chapter:end:index.Rmd-->

# Household Hunger Scale 

## Standardized Questionnaire

Variable Name | Question Label | Answer Choices
---- | ------------- |---- 
HHhSNoFood_YN | In the past [4 weeks/30 days], was there ever no food to eat of any kind in your house because of lack of resources to get food? | 1) Yes 0) No
HHhSNoFood_FR | How often did this happen in the past [4 weeks/30 days]? | 1) Rarely (1–2 times) 2) Sometimes (3–10 times)  3) Often (more than 10 times)
HHhSBedHung_YN | In the past [4 weeks/30 days], did you or any household member go to sleep at night hungry because there was not enough food? | 1) Yes 0) No
HHhSBedHung_FR  | How often did this happen in the past [4 weeks/30 days]? | 1) Rarely (1–2 times) 2) Sometimes (3–10 times)  3) Often (more than 10 times)
HHhSNotEat_YN | In the past [4 weeks/30 days], did you or any household member go to sleep at night hungry because there was not enough food? | 1) Yes 0) No
HHhSNotEat_FR | How often did this happen in the past [4 weeks/30 days]? | 1) Rarely (1–2 times) 2) Sometimes (3–10 times)  3) Often (more than 10 times)

### Paper Version of Questionnaire

Here is the standardized module in word format:
[RBDstandardized_questionnaireHHS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireHHS.xlsx) 

### Electronic Version of Questionnaire

Here is the standardized module in xlsform format:
[RBDstandardized_questionnaireHHS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireHHS.docx) 


## Calculation of Household Hunger Scale Indicators & Cadre Harmonise Phasing

### Example data set

Here is the example data set:
[dataHHSEng](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/example_datasets/dataHHSEng.sav) 

### SPSS Syntax

```{r, eval = F}

GET  FILE='dataHHSEng.sav'.
DATASET NAME DataSet1 WINDOW=FRONT.

** recode the frequency questions to scores

Recode HHhSNoFood_FR HHhSBedHung_FR HHhSNotEat_FR (1 = 1) (2=1) (3=2) (ELSE=0) INTO HHhSNoFood_FR_r HHhSBedHung_FR_r HHhSNotEat_FR_r.

Variable labels HHhSNoFood_FR_r "In the past [4 weeks/30 days], was there ever no food to eat of any kind in your house because of lack of resources to get food? - recoded"
HHhSBedHung_FR_r "In the past [4 weeks/30 days], did you or any household member go to sleep at night hungry because there was not enough food? - recoded"
HHhSNotEat_FR_r "In the past [4 weeks/30 days], did you or any household member go to sleep at night hungry because there was not enough food? - recoded".

** sum the recoded questions to calculate the HHS

Compute HHhS = HHhSNoFood_FR_r + HHhSBedHung_FR_r + HHhSNotEat_FR_r.
variable labels HHhS "Household Hunger Scale".

** each household should have an HHhS score between 0 - 6.

FREQUENCIES VARIABLES = HHhS
/STATISTICS=MEAN MEDIAN MINIMUM MAXIMUM
/ORDER=ANALYSIS.

** Create Categorical HHhS

RECODE HHhS (0 thru 1=1) (2 thru 3=2) (4 thru Highest=3) INTO HHhSCat.
variable labels HHhSCat "Household Hunger Score Categories".
value labels HHhSCat 
1 `No or little hunger in the household`
2 `Moderate hunger in the household`
3 `Severe hunger in the household`.

** Create HHhS Cadre Harmonise Categories

RECODE HHS (0=1) (1=2) (2 thru 3=3) (4=4) (5=5) INTO HHhS_CH.
variable labels HHhS_CH "Household Hunger Score Categories - Cadre Harmonise".
value labels HHhS_CH
1 `Phase1`
2 `Phase2`
3 `Phase3`
4 `Phase4`
5 `Phase5`.

** Generate table of proportion of households in CH HHS phases by Adm1 and Adm2 using weights

WEIGHT BY WeightHH.

CROSSTABS
  /TABLES=ADMIN2Name BY HHhS_CH BY ADMIN1Name
  /FORMAT=AVALUE TABLES
  /CELLS=ROW 
  /COUNT ROUND CELL.

```

Here is the SPSS syntax file: 

[RBDstandardized_SPSSsyntaxHHS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/syntax/RBDstandardized_SPSSsyntaxHHS.sps) 

### R Syntax

```{r, eval = F}
library(haven)
library(labelled)
library(tidyverse)

#import dataset
dataHHSEng <- read_sav("example_datasets/dataHHSEng.sav")

#Calculate HHS 
dataHHSEng <- to_factor(dataHHSEng)

#Recode HHS questions into new variables with score 
dataHHSEng <- dataHHSEng %>% mutate(HHhSNoFood_FR_r = case_when(
                                      HHhSNoFood_FR == "Rarely (1–2 times)" ~ 1,
                                      HHhSNoFood_FR == "Sometimes (3–10 times)" ~ 1,
                                      HHhSNoFood_FR == "Often (more than 10 times)" ~ 2,
                                      TRUE ~ 0),
                                    HHhSBedHung_FR_r = case_when(
                                      HHhSBedHung_FR == "Rarely (1–2 times)" ~ 1,
                                      HHhSBedHung_FR == "Sometimes (3–10 times)" ~ 1,
                                      HHhSBedHung_FR == "Often (more than 10 times)" ~ 2,
                                      TRUE ~ 0),
                                    HHhSNotEat_FR_r = case_when(
                                      HHhSNotEat_FR == "Rarely (1–2 times)" ~ 1,
                                      HHhSNotEat_FR == "Sometimes (3–10 times)" ~ 1,
                                      HHhSNotEat_FR == "Often (more than 10 times)" ~ 2,
                                      TRUE ~ 0))
# Calculate HHhS score
dataHHSEng <- dataHHSEng %>% mutate(HHhS = HHhSNoFood_FR_r + HHhSBedHung_FR_r + HHhSNotEat_FR_r)
var_label(dataHHSEng$HHhS) <- "Household Hunger Scale"

#each household should have an HHS score between 0 - 6
summary(dataHHSEng$HHhS)

# Create Categorical HHS
dataHHSEng <- dataHHSEng %>% mutate(HHhSCat = case_when(
    HHhS %in% c(0,1) ~ "No or little hunger in the household",
    HHhS %in% c(2,3) ~ "Moderate hunger in the household",
    HHhS >= 4 ~ "Severe hunger in the household" 
    ))
var_label(dataHHSEng$HHhSCat) <- "Household Hunger Score Categories"

#Convert HH Scores to CH phases
dataHHSEng <- dataHHSEng %>% mutate(HHhS_CH = case_when(
    HHhS == 0 ~ "Phase1",
    HHhS == 1 ~ "Phase2",
    HHhS %in% c(2,3) ~ "Phase3",
    HHhS == 4 ~ "Phase4",  
    HHhS >= 5 ~ "Phase5"))
var_label(dataHHSEng$HHhS_CH) <- "Household Hunger Score Categories - Cadre Harmonise"

#Generate table of proportion of households in CH HHS phases by Adm1 and Adm2 using weights
CH_HHhS_table_wide <- dataHHSEng %>% group_by(ADMIN1Name, ADMIN2Name) %>%
  drop_na(HHhS_CH) %>%
  count(HHhS_CH, wt = WeightHH) %>%
  mutate(perc = 100 * n / sum(n)) %>%
  ungroup() %>% select(-n) %>%
  spread(key = HHhS_CH, value = perc) %>% replace(., is.na(.), 0)  %>% mutate_if(is.numeric, round, 1)
```


Here is the R syntax file: 

[RBDstandardized_RsyntaxHHS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/syntax/RBDstandardized_RsyntaxHHS.R) 


## References / Resources

1. https://www.fantaproject.org/monitoring-and-evaluation/household-hunger-scale-hhs





<!--chapter:end:01-HHS.Rmd-->

# reduced Coping Strategy Index {#rCSI}

## Standardized Questionnaire

Variable Name | Question Label 
---- | ------------- 
rCSILessQlty | In the past 7 days, how many days has your household had to: *Rely on less preferred and less expensive food* because you did not have enough food or money to buy food?
rCSIBorrow | In the past 7 days, how many days has your household had to: *Borrow food or rely on help from a relative or friend* because you did not have enough food or money to buy food?
rCSIMealSize | In the past 7 days, how many days has your household had to: *Limit portion size of meals* because you did not have enough food or money to buy food?
rCSIMealAdult  | In the past 7 days, how many days has your household had to: *Restrict consumption by adults in order for small children to eat* because you did not have enough food or money to buy food?
rCSIMealNb | In the past 7 days, how many days has your household had to: *Reduce the number of meals eaten per day* because you did not have enough food or money to buy food?


### Paper Version of Questionnaire

Here is the standardized module in word format:
[RBDstandardized_questionnairerCSI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnairerCSI.docx) 

### Electronic Version of Questionnaire

Here is the standardized module in xlsform:
[RBDstandardized_questionnairerCSI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnairerCSI.xlsx) 


## Calculation of rCSI Indicator & CH 

### Example data set

Here is the example data set:
[datarCSIEng](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/example_datasets/datarCSIEng.sav) 

### SPSS Syntax

```{r, eval = F}

GET  FILE='datarCSIEng.sav'.
DATASET NAME DataSet1 WINDOW=FRONT.

** caculate rCSI

compute rCSI = sum(rCSILessQlty,rCSIBorrow*2,rCSIMealSize,rCSIMealAdult*3,rCSIMealNb).
Variable labels rCSI "rCSI".

** each household should have a rCSI between 0 - 56

FREQUENCIES VARIABLES =  rCSI
/STATISTICS=MEAN MEDIAN MINIMUM MAXIMUM
/ORDER=ANALYSIS.

** Create rCSI Cadre Harmonise Categories

RECODE rCSI (0 thru 3=1) (4 thru 18=2) (19 thru 56=3) INTO rCSI_CH.
variable labels rCSI_CH "rCSI categories - Cadre Harmonise ".
value labels rCSI_CH
1 `Phase1`
2 `Phase2`
3 `Phase3`.

** Generate table of proportion of households in CH HHhS phases by Adm1 and Adm2 using weights

WEIGHT BY WeightHH.

CROSSTABS
  /TABLES=ADMIN2Name BY rCSI_CH BY ADMIN1Name
  /FORMAT=AVALUE TABLES
  /CELLS=ROW 
  /COUNT ROUND CELL.


```

Here is the SPSS syntax file: 

[RBDstandardized_SPSSsyntaxrCSI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/syntax/RBDstandardized_SPSSsyntaxrCSI.sps) 


### R Syntax

```{r, eval = F}
library(haven)
library(labelled)
library(tidyverse)

#import dataset
datarCSIEng <- read_sav("example_datasets/datarCSIEng.sav")

#Calculate HHS 
datarCSIEng <- to_factor(datarCSIEng)

#calculate rCSI Score
datarCSIEng <- datarCSIEng %>% mutate(rCSI = rCSILessQlty  + (2 * rCSIBorrow) + rCSIMealSize + (3 * rCSIMealAdult) + rCSIMealNb)
var_label(datarCSIEng$rCSI) <- "rCSI"

#each household should have a rCSI between 0 - 56

summary(datarCSIEng$rCSI)

#Create rCSI Cadre Harmonise Categories
datarCSIEng <- datarCSIEng %>% mutate(rCSI_CH = case_when(
  rCSI <= 3 ~ "Phase1", 
  between(rCSI,4,18) ~ "Phase2",       
  rCSI >= 19 ~ "Phase3"))
var_label(datarCSIEng$rCSI_CH) <- "rCSI categories - Cadre Harmonise "

#Generate table of proportion of households in CH rCSI phases by Adm1 and Adm2 using weights
CH_rCSI_table_wide <- datarCSIEng %>% group_by(ADMIN1Name, ADMIN2Name) %>%
  drop_na(rCSI_CH) %>%
  count(rCSI_CH, wt = WeightHH) %>%
  mutate(perc = 100 * n / sum(n)) %>%
  ungroup() %>% select(-n) %>%
  spread(key = rCSI_CH, value = perc) %>% replace(., is.na(.), 0)  %>% mutate_if(is.numeric, round, 1)
```

Here is the R syntax file: 

[RBDstandardized_RsyntaxrCSI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/syntax/RBDstandardized_RsyntaxrCSI.R) 


## References / Resources

1. https://documents.wfp.org/stellent/groups/public/documents/manual_guide_proced/wfp211058.pdf

2. https://documents.wfp.org/stellent/groups/public/documents/manual_guide_proced/wfp271449.pdf


<!--chapter:end:02-rCSI.Rmd-->

# Food Consumption Score & Household Dietary Diversity

The modules below allow you to collect and calculate FCS, FCS-N and HDDS indicators.

## Standardized Questionnaire

### Paper Version of Questionnaire

Here is the standardized module in word format:

[RBDstandardized_questionnaireFCSHDDS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireFCSHDDS.docx) 

### Electronic Version of Questionnaire

Here is the standardized module in xlsform:

[RBDstandardized_questionnaireFCSHDDS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireFCSHDDS.xlsx)

## Calculation of FCS & HDDS Indicators  

### Example data set

Here is the example data set:
[dataFCSHDDSEng](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/example_datasets/dataFCSHDDSEng.sav) 

still need to create 

### SPSS Syntax

```{r, eval = F}

to be added

```

Here is the SPSS syntax file: 

not done yet

### R Syntax

```{r, eval = F}
library(haven)
library(labelled)
library(tidyverse)

#import dataset
dataFCSHDDSEng <- read_sav("example_datasets/dataFCSHDDSEng.sav")
#convert to labels
dataFCSHDDSEng <- to_factor(dataFCSHDDSEng)

#calculate FCS
dataFCSHDDSEng <- dataFCSHDDSEng %>% mutate(FCS = (2 * FCSStap) + (3 * FCSPulse)+ (4*FCSPr) +FCSVeg  +FCSFruit +(4*FCSDairy) + (0.5*FCSFat) + (0.5*FCSSugar))
#create FCG groups based on 21/25 or 28/42 thresholds
dataFCSHDDSEng <- dataFCSHDDSEng %>% mutate(
  FCSCat21 = case_when(
  FCS <= 21 ~ "Poor", between(FCS, 21.5, 35) ~ "Borderline", FCS > 35 ~ "Acceptable"),
  FCSCat28 = case_when(
  FCS <= 28 ~ "Poor", between(FCS, 28.5, 42) ~ "Borderline", FCS > 42 ~ "Acceptable"))
var_label(dataFCSHDDSEng$FCSCat21) <- "Food Consumption Group 21/35 thresholds"
var_label(dataFCSHDDSEng$FCSCat28) <-  "Food Consumption Group 28/42 thresholds"



#calculate HDDS first by creating the 12 groups based on the 16 questions 
dataFCSHDDSEng <- dataFCSHDDSEng %>% mutate(
    HDDSStapCer = case_when(HDDSStapCer == "Yes" ~ 1, TRUE ~ 0),
    HDDSStapRoot = case_when(HDDSStapRoot  == "Yes" ~ 1, TRUE ~ 0),
    HDDSVeg = case_when(HDDSVegOrg  == "Yes" | HDDSVegGre == "Yes" | HDDSVegOth == "Yes" ~ 1, TRUE ~ 0),
    HDDSFruit = case_when(HDDSFruitOrg == "Yes" | HDDSFruitOth == "Yes" ~ 1, TRUE ~ 0),
    HDDSPrMeat = case_when(HDDSPrMeatF == "Yes" | HDDSPrMeatO == "Yes" ~ 1, TRUE ~ 0),
    HDDSPrEgg = case_when(HDDSPrEgg  == "Yes" ~ 1, TRUE ~ 0),
    HDDSPrFish = case_when(HDDSPrFish == "Yes" ~ 1, TRUE ~ 0),
    HDDSPulse = case_when(HDDSPulse == "Yes" ~ 1, TRUE ~ 0),
    HDDSDairy = case_when(HDDSDairy == "Yes" ~ 1, TRUE ~ 0),
    HDDSFat = case_when(HDDSFat == "Yes" ~ 1, TRUE ~ 0),
    HDDSSugar = case_when(HDDSSugar == "Yes" ~ 1, TRUE ~ 0),
    HDDSCond = case_when(HDDSCond == "Yes"~ 1, TRUE ~ 0))

#Calculate HDDS and Cadre Harmonise Phases
dataFCSHDDSEng <- dataFCSHDDSEng %>% mutate(HDDS = HDDSStapCer +HDDSStapRoot +HDDSVeg +HDDSFruit +HDDSPrMeat +HDDSPrEgg +HDDSPrFish +HDDSPulse +HDDSDairy +HDDSFat +HDDSSugar +HDDSCond)
var_label(dataFCSHDDSEng$HDDS) <- "Hosehold Dietary Diversity Score"

#Calucate Cadre Harmonise HDDS phasing categories 
dataFCSHDDSEng <- dataFCSHDDSEng %>%  mutate(HDDS_CH = case_when(
    HDDS >= 5 ~ "Phase1", 
    HDDS == 4 ~ "Phase2",       
    HDDS == 3 ~ "Phase3",
    HDDS == 2 ~ "Phase4",
    HDDS < 2 ~ "Phase5"))
var_label(dataFCSHDDSEng$HDDS_CH) <- "Hosehold Dietary Diversity Score - CH phasing"

#Generate table of proportion of households in FCG by Adm1 and Adm2 using weights 
#Food Consumption Group 21/35 cutoff 
FCSCat_table_wide <- dataFCSHDDSEng %>% 
  drop_na(FCSCat21) %>%
  group_by(ADMIN1Name, ADMIN2Name) %>%
  count(FCSCat21, wt = WeightHH) %>%
  mutate(perc = 100 * n / sum(n)) %>%
  ungroup() %>% select(-n) %>%
  spread(key = FCSCat21, value = perc) %>% replace(., is.na(.), 0) %>% mutate_if(is.numeric, round, 1)

#Generate table of proportion of households by HDDS by Adm1 and Adm2 using weights
#Food Consumption Group 21/35 cutoff 
CH_HDDS_table_wide <- dataFCSHDDSEng %>% 
  drop_na(HDDS_CH) %>%
  group_by(ADMIN1Name, ADMIN2Name) %>%
  count(HDDS_CH, wt = WeightHH) %>%
  mutate(perc = 100 * n / sum(n)) %>%
  ungroup() %>% select(-n) %>%
  spread(key = HDDS_CH, value = perc) %>% replace(., is.na(.), 0) %>% mutate_if(is.numeric, round, 1)
```


Here is the R syntax file: 

[RBDstandardized_RsyntaxFCSHDDS](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/syntax/RBDstandardized_RsyntaxFCSHDDS.R) 


## References / Resources

1.  FCS - https://documents.wfp.org/stellent/groups/public/documents/manual_guide_proced/wfp271449.pdf

2.  FCS_N - https://documents.wfp.org/stellent/groups/public/documents/manual_guide_proced/wfp277333.pdf

3.  HDDS - http://www.fao.org/fileadmin/user_upload/wa_workshop/docs/FAO-guidelines-dietary-diversity2011.pdf




<!--chapter:end:03-FCSHDDS.Rmd-->

# Livelihood Coping Strategies

## Standardized Light CARI Module 

Variable Name | Question Label | Answer Choices
---- | ------------- |------- 
LhCSIStress1 | During the past 30 days, did anyone in your household have to: *Sell household assets/goods  radio, furniture, refrigerator, television, jewelry etc..)* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress2 | During the past 30 days, did anyone in your household have to: *sell more animals (non-productive) than usual* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress3 | During the past 30 days, did anyone in your household have to: *spend savings* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress4 | During the past 30 days, did anyone in your household have to: *Borrow money / food  from a formal lender / bank* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSICrisis1 | During the past 30 days, did anyone in your household have to: *Reduce non-food expenses on health (including drugs) and education * due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSICrisis2 | During the past 30 days, did anyone in your household have to: *sell productive assets or means of transport (sewing machine, wheelbarrow, bicycle, car, etc..)* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSICrisis3 | During the past 30 days, did anyone in your household have to: *withdraw children from school* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIEmergency1 | During the past 30 days, did anyone in your household have to: *sell house or land* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIEmergency2 | During the past 30 days, did anyone in your household have to: *sell last female animals* due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIEmergency3 | During the past 30 days, did anyone in your household have to: *beg * due to a lack of food or a lack of money to buy food? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable

### Paper Version of Questionnaire

Here is the standardized module in word format:
[RBDstandardized_questionnaireLHCS_CARI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireLHCS_CARI.docx) 

### Electronic Version of Questionnaire

Here is the standardized module in xlsform:

[RBDstandardized_questionnaireLHCS_CARI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireLHCS_CARI.xlsx) 

### Analysis 

#### Example data set
[dataLHCS_CARIEng](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/example_datasets/dataLHCS_CARIEng.sav) 

Here is the example data set:

#### SPSS Syntax

```{r, eval = F}
not availible yet
```

Here is the SPSS syntax file: 

still need to do


#### R Syntax

```{r, eval = F}
library(haven)
library(labelled)
library(tidyverse)

#import dataset
dataLHCS_CARIEng <- read_sav("example_datasets/dataLHCS_CARIEng.sav")

#Calculate HHS 
dataLHCS_CARIEng<- to_factor(dataLHCS_CARIEng)

#create a variable to specify if the household used any of the strategies by severity 
#stress
dataLHCS_CARIEng <- dataLHCS_CARIEng %>% mutate(stress_coping = case_when(
LhCSIStress1 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedstress",
LhCSIStress2 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedstress",
LhCSIStress3 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedstress",
LhCSIStress4 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedstress",
TRUE ~ "notusedstress"))
#Crisis
dataLHCS_CARIEng <- dataLHCS_CARIEng %>% mutate(crisis_coping = case_when(
LhCSICrisis1 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedcrisis",
LhCSICrisis2 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedcrisis",
LhCSICrisis3 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedcrisis",
TRUE ~ "notusedcrisis"))
#Emergency
dataLHCS_CARIEng <- dataLHCS_CARIEng %>% mutate(emergency_coping = case_when(
LhCSIEmergency1 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedemergency",
LhCSIEmergency2 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedemergency",
LhCSIEmergency3 %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") ~ "usedemergency",
TRUE ~ "noutusedemergency"))

#calculate Max_coping_behaviour
dataLHCS_CARIEng <- dataLHCS_CARIEng %>% mutate(LhCSICat = case_when(
  emergency_coping == "usedemergency" ~ "EmergencyStrategies",
  crisis_coping == "usedcrisis" ~ "CrisisStrategies",
  stress_coping == "usedstress" ~ "StressStrategies",
  TRUE ~ "NoStrategies"))
var_label(dataLHCS_CARIEng$LhCSICat) <- "Livelihood Coping Strategy categories - CARI light version"



#Generate table of proportion of households in CH LhCHS phases by Adm1 and Adm2 using weights
#Livelihood Coping Strategies 
LhHCSCat_table_wide <- dataLHCS_CARIEng %>% 
  drop_na(LhCSICat) %>%
  group_by(ADMIN1Name, ADMIN2Name) %>%
  count(LhCSICat, wt = WeightHH) %>%
  mutate(perc = 100 * n / sum(n)) %>%
  ungroup() %>% select(-n) %>%
  spread(key = LhCSICat, value = perc) %>% replace(., is.na(.), 0) %>% mutate_if(is.numeric, round, 1)
```


Here is the R syntax file: 

[RBDstandardized_RsyntaxLHCSI_light_CARI](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/syntax/RBDstandardized_RsyntaxLHCSI_CARI.R) 


## Standardized Module - Essential Needs Assessment (ENA)

Variable Name | Question Label | Answer Choices
---- | ------------- |--------------- 
LhCSIStress1_EN | During the past 30 days, did anyone in your household have to: *Sell household assets/goods (radio, furniture, refrigerator, television, jewelry etc..)* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress1_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSIStress2_EN | During the past 30 days, did anyone in your household have to: *Purchase food on credit or borrow food* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress2_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSIStress3_EN | During the past 30 days, did anyone in your household have to: *spend savings* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress3_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSIStress4_EN | During the past 30 days, did anyone in your household have to: *Borrow money* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIStress4_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSICrisis1_EN | During the past 30 days, did anyone in your household have to: *sell productive assets or means of transport (sewing machine, wheelbarrow, bicycle, car, etc..)* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSICrisis1_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSICrisis2_EN | During the past 30 days, did anyone in your household have to: *consume seed stocks that were to be held/saved for the next season* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSICrisis2_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSICrisis3_EN | During the past 30 days, did anyone in your household have to: *Withdraw children from school* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSICrisis3_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSIEmergency1_EN | During the past 30 days, did anyone in your household have to: *Sell house or land because there was not enough resources (food, cash, else)*  because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIEmergency1_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSIEmergency2_EN | During the past 30 days, did anyone in your household have to: *Beg* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIEmergency2_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other
LhCSIEmergency3_EN| During the past 30 days, did anyone in your household have to: *Sell last female animals* because there was not enough resources (food, cash, else) to meet essential needs (e.g. adequate shelter, education services, health services, food, etc)? | 1) No, because I did not face a shortage of food 2) No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it 3) Yes 4) Not applicable
LhCSIEmergency3_EN_why | What was the MAIN REASON you or other members in your household adopted these coping strategies to access essential needs? | 1)To access food 2)To access education services/commodities (e.g. uniforms, books) 3)To access health services/medicines 4)To buy and repair cloths or shoes 5)To access adequate shelter 6)To access water/sanitation facilities 7)To access essential dwelling services (electricity, energy, waste disposal…) 8)To pay for existing debts 9)Other

## Standardized Module - Essential Needs Assessment (ENA)

### Paper Version of Questionnaire

Here is the standardized module in word format:
[RBDstandardized_questionnaireLHCS_ENA](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireLHCS_ENA.docx) 

### Electronic Version of Questionnaire

Here is the standardized module in xlsform:

[RBDstandardized_questionnaireLHCS_ENA](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/RBDstandardized_questionnaireLHCS_ENA.xlsx) 

### Analysis 

#### Example data set

Here is the example data set:

not available yet


#### SPSS Syntax

```{r, eval = F}
```

Here is the SPSS syntax file: 

still need to do


#### R Syntax

```{r, eval = F}
library(haven)
library(labelled)
library(tidyverse)

#import dataset
dataLHCS_ENAEng <- read_sav("example_datasets/dataLHCS_ENAEng.sav")

#Calculate HHS 
dataLHCS_ENAEng<- to_factor(dataLHCS_ENAEng)

#create a variable to specify if the household used any of the strategies by severity 
#stress
dataLHCS_ENAEng <- dataLHCS_ENAEng %>% mutate(stress_coping = case_when(
LhCSIStress1_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") & 
LhCSIStress1_EN_why == "To buy food" ~ "usedstress",
LhCSIStress2_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") &
LhCSIStress2_EN_why == "To buy food" ~ "usedstress",
LhCSIStress3_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") &
LhCSIStress3_EN_why == "To buy food" ~ "usedstress",
LhCSIStress4_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") &
LhCSIStress4_EN_why == "To buy food" ~ "usedstress",
TRUE ~ "notusedstress"))
#Crisis
dataLHCS_ENAEng <- dataLHCS_ENAEng %>% mutate(crisis_coping = case_when(
LhCSICrisis1_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") & 
LhCSICrisis1_EN_why == "To buy food" ~ "usedcrisis",
LhCSICrisis2_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") & 
LhCSICrisis2_EN_why == "To buy food" ~ "usedcrisis",
LhCSICrisis3_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") &
LhCSICrisis3_EN_why == "To buy food" ~ "usedcrisis",
TRUE ~ "notusedcrisis"))
#Emergency
dataLHCS_ENAEng <- dataLHCS_ENAEng %>% mutate(emergency_coping = case_when(
LhCSIEmergency1_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") & 
LhCSIEmergency1_EN_why == "To buy food" ~ "usedemergency",
LhCSIEmergency2_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") & 
LhCSIEmergency2_EN_why == "To buy food" ~ "usedemergency",
LhCSIEmergency3_EN %in% c("Yes","No; because I already sold those assets or did this activity in the last 12 months and cannot continue to do it") & 
LhCSIEmergency3_EN_why == "To buy food" ~ "usedemergency",
TRUE ~ "noutusedemergency"))

#calculate Max_coping_behaviour
dataLHCS_ENAEng <- dataLHCS_ENAEng %>% mutate(LhCSICat_ENA = case_when(
  emergency_coping == "usedemergency" ~ "EmergencyStrategies",
  crisis_coping == "usedcrisis" ~ "CrisisStrategies",
  stress_coping == "usedstress" ~ "StressStrategies",
  TRUE ~ "NoStrategies"))
var_label(dataLHCS_ENAEng$LhCSICat_ENA) <- "Livelihood Coping Strategy categories - ENA version"

#Generate table of proportion of households in LhCHS  phases by Adm1 and Adm2 using weights
#Livelihood Coping Strategies 
LhHCSCat_table_wide <- dataLHCS_ENAEng %>% 
  drop_na(LhCSICat_ENA) %>%
  group_by(ADMIN1Name, ADMIN2Name) %>%
  count(LhCSICat_ENA , wt = WeightHH) %>%
  mutate(perc = 100 * n / sum(n)) %>%
  ungroup() %>% select(-n) %>%
  spread(key = LhCSICat_ENA, value = perc) %>% replace(., is.na(.), 0) %>% mutate_if(is.numeric, round, 1)
```


Here is the R syntax file: 

not available yet


## References / Resources

1.  Standard Livelihood Coping Strategies  - https://documents.wfp.org/stellent/groups/public/documents/manual_guide_proced/wfp271449.pdf

2.  ENA Livelihood Coping Strategies - https://docs.wfp.org/api/documents/WFP-0000074197/download/?








<!--chapter:end:04-LHCS.Rmd-->

# Gecodes

Using names as identifiers can easily lead to confusion over spelling and transliterations as well as alternative and duplicate names.

As unique identifiers, P-Codes overcome the challenges of linking datasets and confirming locations.

We recommend using Gecodes and Names from OCHA's Common Operational Datasets: 
https://data.humdata.org/dashboards/cod?ext_geodata=1&q=&ext_page_size=25

## A brief example of the problem:

The geographic variables of the *choices* section of the  xlsform typically look like this

list_name | name | label
---- | --- |---- 
cod_lga | 1 | ASKIRA/UBA
cod_lga | 2 | BAYO
cod_lga | 3 | CHIBOK
cod_lga | 4 | KALABAGE

The geographic variables in corresponding GIS dataset look like this:

Shape | admin2Pcode | admin2RefName
---- | --- |---- 
Polygon |NG008002 | Askira/Uba
Polygon |NG008004 | Bayo
Polygon |NG008006 | Chibok
Polygon |NG008015 | Kala/Balge

Unfortunately, if we tried to merge the dataset and the GIS file by the name of the area, we would first have to fix the capitalization and punctuation of the names.

To avoid unnecessary work, we recommend putting in the *Pcode* in the name column of the xlsform:

list_name | name | label
---- | --- |---- 
cod_lga | NG008002 | ASKIRA/UBA
cod_lga | NG008004 | BAYO
cod_lga | NG008006 | CHIBOK
cod_lga | NG008015 | KALABAGE

With a common, simple variable to merge both datasets, mapping and data processing will be much easier!

## Where to find Pcodes

Geographic data can be found https://data.humdata.org/dashboards/cod?ext_geodata=1&q=&ext_page_size=25 and searching for the appropriate country.

We recommend using the codes from the *admin1Pcode* and *admin2Pcode* columns in the *name* column of the xlsform.  Using the *admin1RefName* and *admin2RefName*

## Example data set of the data collection sheet for Nigeria:
[xlsformwithgeocodesexample](https://github.com/WFP-VAM/RBD_FS_CH_guide_EN/blob/master/questionnaires/xlsformwithgeocodesexample.xlsx) 



## 2 caveats

1. In some countries, the boundaries in the CODS might not correspond with the latest boundaries used by the country.  In this case, special development of a GIS boundary file and codes will need to be developed.

2. Inserting the relevant pcodes in the *name* column will probably require some *vlookup* .  This might be relatively straightforward when only replacing codes at the admin1 and admin2 level, however things might get more complicated and difficult if cascading columns and the *choice_filter* option is used at the adm3, adm4 level. 




<!--chapter:end:05-Geocodes.Rmd-->

# Example of Data Quality Report

<!--chapter:end:06-DataQuality.Rmd-->

